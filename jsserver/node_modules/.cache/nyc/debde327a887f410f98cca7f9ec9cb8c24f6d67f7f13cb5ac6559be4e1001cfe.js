var cov_22f7estkm1=function(){var path="/Users/hb/latlib/jsserver/javascript-algorithms/src/algorithms/graph/hamiltonian-cycle/hamiltonianCycle.js";var hash="e9d8e536c154b930ed1d11ce89f7fe737ad4657d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/hb/latlib/jsserver/javascript-algorithms/src/algorithms/graph/hamiltonian-cycle/hamiltonianCycle.js",statementMap:{"0":{start:{line:11,column:20},end:{line:11,column:43}},"1":{start:{line:14,column:40},end:{line:14,column:81}},"2":{start:{line:15,column:34},end:{line:15,column:69}},"3":{start:{line:18,column:2},end:{line:20,column:3}},"4":{start:{line:19,column:4},end:{line:19,column:17}},"5":{start:{line:23,column:29},end:{line:23,column:95}},"6":{start:{line:23,column:50},end:{line:23,column:94}},"7":{start:{line:25,column:2},end:{line:25,column:29}},"8":{start:{line:38,column:22},end:{line:38,column:30}},"9":{start:{line:39,column:20},end:{line:39,column:43}},"10":{start:{line:42,column:36},end:{line:42,column:73}},"11":{start:{line:43,column:34},end:{line:43,column:69}},"12":{start:{line:46,column:2},end:{line:46,column:90}},"13":{start:{line:64,column:23},end:{line:64,column:78}},"14":{start:{line:64,column:48},end:{line:64,column:77}},"15":{start:{line:66,column:2},end:{line:74,column:3}},"16":{start:{line:69,column:4},end:{line:72,column:5}},"17":{start:{line:71,column:6},end:{line:71,column:32}},"18":{start:{line:73,column:4},end:{line:73,column:11}},"19":{start:{line:76,column:2},end:{line:98,column:3}},"20":{start:{line:76,column:25},end:{line:76,column:26}},"21":{start:{line:78,column:28},end:{line:78,column:49}},"22":{start:{line:81,column:4},end:{line:97,column:5}},"23":{start:{line:83,column:6},end:{line:83,column:41}},"24":{start:{line:86,column:6},end:{line:92,column:9}},"25":{start:{line:96,column:6},end:{line:96,column:25}},"26":{start:{line:108,column:26},end:{line:108,column:52}},"27":{start:{line:109,column:26},end:{line:109,column:52}},"28":{start:{line:110,column:19},end:{line:110,column:41}},"29":{start:{line:115,column:22},end:{line:115,column:33}},"30":{start:{line:118,column:17},end:{line:118,column:19}},"31":{start:{line:121,column:16},end:{line:121,column:29}},"32":{start:{line:124,column:2},end:{line:130,column:5}},"33":{start:{line:133,column:2},end:{line:133,column:16}}},fnMap:{"0":{name:"isSafe",decl:{start:{line:10,column:9},end:{line:10,column:15}},loc:{start:{line:10,column:74},end:{line:26,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:23,column:40},end:{line:23,column:41}},loc:{start:{line:23,column:50},end:{line:23,column:94}},line:23},"2":{name:"isCycle",decl:{start:{line:34,column:9},end:{line:34,column:16}},loc:{start:{line:34,column:58},end:{line:47,column:1}},line:34},"3":{name:"hamiltonianCycleRecursive",decl:{start:{line:56,column:9},end:{line:56,column:34}},loc:{start:{line:62,column:3},end:{line:99,column:1}},line:62},"4":{name:"(anonymous_4)",decl:{start:{line:64,column:38},end:{line:64,column:39}},loc:{start:{line:64,column:48},end:{line:64,column:77}},line:64},"5":{name:"hamiltonianCycle",decl:{start:{line:105,column:24},end:{line:105,column:40}},loc:{start:{line:105,column:48},end:{line:134,column:1}},line:105}},branchMap:{"0":{loc:{start:{line:18,column:2},end:{line:20,column:3}},type:"if",locations:[{start:{line:18,column:2},end:{line:20,column:3}},{start:{line:18,column:2},end:{line:20,column:3}}],line:18},"1":{loc:{start:{line:66,column:2},end:{line:74,column:3}},type:"if",locations:[{start:{line:66,column:2},end:{line:74,column:3}},{start:{line:66,column:2},end:{line:74,column:3}}],line:66},"2":{loc:{start:{line:69,column:4},end:{line:72,column:5}},type:"if",locations:[{start:{line:69,column:4},end:{line:72,column:5}},{start:{line:69,column:4},end:{line:72,column:5}}],line:69},"3":{loc:{start:{line:81,column:4},end:{line:97,column:5}},type:"if",locations:[{start:{line:81,column:4},end:{line:97,column:5}},{start:{line:81,column:4},end:{line:97,column:5}}],line:81}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"e9d8e536c154b930ed1d11ce89f7fe737ad4657d"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();import GraphVertex from'../../../data-structures/graph/GraphVertex';/**
 * @param {number[][]} adjacencyMatrix
 * @param {object} verticesIndices
 * @param {GraphVertex[]} cycle
 * @param {GraphVertex} vertexCandidate
 * @return {boolean}
 */function isSafe(adjacencyMatrix,verticesIndices,cycle,vertexCandidate){cov_22f7estkm1.f[0]++;const endVertex=(cov_22f7estkm1.s[0]++,cycle[cycle.length-1]);// Get end and candidate vertices indices in adjacency matrix.
const candidateVertexAdjacencyIndex=(cov_22f7estkm1.s[1]++,verticesIndices[vertexCandidate.getKey()]);const endVertexAdjacencyIndex=(cov_22f7estkm1.s[2]++,verticesIndices[endVertex.getKey()]);// Check if last vertex in the path and candidate vertex are adjacent.
cov_22f7estkm1.s[3]++;if(adjacencyMatrix[endVertexAdjacencyIndex][candidateVertexAdjacencyIndex]===Infinity){cov_22f7estkm1.b[0][0]++;cov_22f7estkm1.s[4]++;return false;}else{cov_22f7estkm1.b[0][1]++;}// Check if vertexCandidate is being added to the path for the first time.
const candidateDuplicate=(cov_22f7estkm1.s[5]++,cycle.find(vertex=>{cov_22f7estkm1.f[1]++;cov_22f7estkm1.s[6]++;return vertex.getKey()===vertexCandidate.getKey();}));cov_22f7estkm1.s[7]++;return!candidateDuplicate;}/**
 * @param {number[][]} adjacencyMatrix
 * @param {object} verticesIndices
 * @param {GraphVertex[]} cycle
 * @return {boolean}
 */function isCycle(adjacencyMatrix,verticesIndices,cycle){cov_22f7estkm1.f[2]++;// Check if first and last vertices in hamiltonian path are adjacent.
// Get start and end vertices from the path.
const startVertex=(cov_22f7estkm1.s[8]++,cycle[0]);const endVertex=(cov_22f7estkm1.s[9]++,cycle[cycle.length-1]);// Get start/end vertices indices in adjacency matrix.
const startVertexAdjacencyIndex=(cov_22f7estkm1.s[10]++,verticesIndices[startVertex.getKey()]);const endVertexAdjacencyIndex=(cov_22f7estkm1.s[11]++,verticesIndices[endVertex.getKey()]);// Check if we can go from end vertex to the start one.
cov_22f7estkm1.s[12]++;return adjacencyMatrix[endVertexAdjacencyIndex][startVertexAdjacencyIndex]!==Infinity;}/**
 * @param {number[][]} adjacencyMatrix
 * @param {GraphVertex[]} vertices
 * @param {object} verticesIndices
 * @param {GraphVertex[][]} cycles
 * @param {GraphVertex[]} cycle
 */function hamiltonianCycleRecursive({adjacencyMatrix,vertices,verticesIndices,cycles,cycle}){cov_22f7estkm1.f[3]++;// Clone cycle in order to prevent it from modification by other DFS branches.
const currentCycle=(cov_22f7estkm1.s[13]++,[...cycle].map(vertex=>{cov_22f7estkm1.f[4]++;cov_22f7estkm1.s[14]++;return new GraphVertex(vertex.value);}));cov_22f7estkm1.s[15]++;if(vertices.length===currentCycle.length){cov_22f7estkm1.b[1][0]++;cov_22f7estkm1.s[16]++;// Hamiltonian path is found.
// Now we need to check if it is cycle or not.
if(isCycle(adjacencyMatrix,verticesIndices,currentCycle)){cov_22f7estkm1.b[2][0]++;cov_22f7estkm1.s[17]++;// Another solution has been found. Save it.
cycles.push(currentCycle);}else{cov_22f7estkm1.b[2][1]++;}cov_22f7estkm1.s[18]++;return;}else{cov_22f7estkm1.b[1][1]++;}cov_22f7estkm1.s[19]++;for(let vertexIndex=(cov_22f7estkm1.s[20]++,0);vertexIndex<vertices.length;vertexIndex+=1){// Get vertex candidate that we will try to put into next path step and see if it fits.
const vertexCandidate=(cov_22f7estkm1.s[21]++,vertices[vertexIndex]);// Check if it is safe to put vertex candidate to cycle.
cov_22f7estkm1.s[22]++;if(isSafe(adjacencyMatrix,verticesIndices,currentCycle,vertexCandidate)){cov_22f7estkm1.b[3][0]++;cov_22f7estkm1.s[23]++;// Add candidate vertex to cycle path.
currentCycle.push(vertexCandidate);// Try to find other vertices in cycle.
cov_22f7estkm1.s[24]++;hamiltonianCycleRecursive({adjacencyMatrix,vertices,verticesIndices,cycles,cycle:currentCycle});// BACKTRACKING.
// Remove candidate vertex from cycle path in order to try another one.
cov_22f7estkm1.s[25]++;currentCycle.pop();}else{cov_22f7estkm1.b[3][1]++;}}}/**
 * @param {Graph} graph
 * @return {GraphVertex[][]}
 */export default function hamiltonianCycle(graph){cov_22f7estkm1.f[5]++;// Gather some information about the graph that we will need to during
// the problem solving.
const verticesIndices=(cov_22f7estkm1.s[26]++,graph.getVerticesIndices());const adjacencyMatrix=(cov_22f7estkm1.s[27]++,graph.getAdjacencyMatrix());const vertices=(cov_22f7estkm1.s[28]++,graph.getAllVertices());// Define start vertex. We will always pick the first one
// this it doesn't matter which vertex to pick in a cycle.
// Every vertex is in a cycle so we can start from any of them.
const startVertex=(cov_22f7estkm1.s[29]++,vertices[0]);// Init cycles array that will hold all solutions.
const cycles=(cov_22f7estkm1.s[30]++,[]);// Init cycle array that will hold current cycle path.
const cycle=(cov_22f7estkm1.s[31]++,[startVertex]);// Try to find cycles recursively in Depth First Search order.
cov_22f7estkm1.s[32]++;hamiltonianCycleRecursive({adjacencyMatrix,vertices,verticesIndices,cycles,cycle});// Return found cycles.
cov_22f7estkm1.s[33]++;return cycles;}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYi9sYXRsaWIvanNzZXJ2ZXIvamF2YXNjcmlwdC1hbGdvcml0aG1zL3NyYy9hbGdvcml0aG1zL2dyYXBoL2hhbWlsdG9uaWFuLWN5Y2xlL2hhbWlsdG9uaWFuQ3ljbGUuanMiXSwibmFtZXMiOlsiR3JhcGhWZXJ0ZXgiLCJpc1NhZmUiLCJhZGphY2VuY3lNYXRyaXgiLCJ2ZXJ0aWNlc0luZGljZXMiLCJjeWNsZSIsInZlcnRleENhbmRpZGF0ZSIsImVuZFZlcnRleCIsImxlbmd0aCIsImNhbmRpZGF0ZVZlcnRleEFkamFjZW5jeUluZGV4IiwiZ2V0S2V5IiwiZW5kVmVydGV4QWRqYWNlbmN5SW5kZXgiLCJJbmZpbml0eSIsImNhbmRpZGF0ZUR1cGxpY2F0ZSIsImZpbmQiLCJ2ZXJ0ZXgiLCJpc0N5Y2xlIiwic3RhcnRWZXJ0ZXgiLCJzdGFydFZlcnRleEFkamFjZW5jeUluZGV4IiwiaGFtaWx0b25pYW5DeWNsZVJlY3Vyc2l2ZSIsInZlcnRpY2VzIiwiY3ljbGVzIiwiY3VycmVudEN5Y2xlIiwibWFwIiwidmFsdWUiLCJwdXNoIiwidmVydGV4SW5kZXgiLCJwb3AiLCJoYW1pbHRvbmlhbkN5Y2xlIiwiZ3JhcGgiLCJnZXRWZXJ0aWNlc0luZGljZXMiLCJnZXRBZGphY2VuY3lNYXRyaXgiLCJnZXRBbGxWZXJ0aWNlcyJdLCJtYXBwaW5ncyI6ImcrSUFBQSxNQUFPQSxDQUFBQSxXQUFQLEtBQXdCLDRDQUF4QixDQUVBOzs7Ozs7R0FPQSxRQUFTQyxDQUFBQSxNQUFULENBQWdCQyxlQUFoQixDQUFpQ0MsZUFBakMsQ0FBa0RDLEtBQWxELENBQXlEQyxlQUF6RCxDQUEwRSx1QkFDeEUsS0FBTUMsQ0FBQUEsU0FBUyx3QkFBR0YsS0FBSyxDQUFDQSxLQUFLLENBQUNHLE1BQU4sQ0FBZSxDQUFoQixDQUFSLENBQWYsQ0FFQTtBQUNBLEtBQU1DLENBQUFBLDZCQUE2Qix3QkFBR0wsZUFBZSxDQUFDRSxlQUFlLENBQUNJLE1BQWhCLEVBQUQsQ0FBbEIs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RCwrQkFpQkQsQ0FDRixDQUVEOzs7R0FJQSxjQUFlLFNBQVNDLENBQUFBLGdCQUFULENBQTBCQyxLQUExQixDQUFpQyx1QkFDOUM7QUFDQTtBQUNBLEtBQU16QixDQUFBQSxlQUFlLHlCQUFHeUIsS0FBSyxDQUFDQyxrQkFBTixFQUFILENBQXJCLENBQ0EsS0FBTTNCLENBQUFBLGVBQWUseUJBQUcwQixLQUFLLENBQUNFLGtCQUFOLEVBQUgsQ0FBckIsQ0FDQSxLQUFNWCxDQUFBQSxRQUFRLHlCQUFHUyxLQUFLLENBQUNHLGNBQU4sRUFBSCxDQUFkLENBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBTWYsQ0FBQUEsV0FBVyx5QkFBR0csUUFBUSxDQUFDLENBQUQsQ0FBWCxDQUFqQixDQUVBO0FBQ0EsS0FBTUMsQ0FBQUEsTUFBTSx5QkFBRyxFQUFILENBQVosQ0FFQTtBQUNBLEtBQU1oQixDQUFBQSxLQUFLLHlCQUFHLENBQUNZLFdBQUQsQ0FBSCxDQUFYLENBRUE7QUFsQjhDLHVCQW1COUNFLHlCQUF5QixDQUFDLENBQ3hCaEIsZUFEd0IsQ0FFeEJpQixRQUZ3QixDQUd4QmhCLGVBSHdCLENBSXhCaUIsTUFKd0IsQ0FLeEJoQixLQUx3QixDQUFELENBQXpCLENBUUE7QUEzQjhDLHVCQTRCOUMsTUFBT2dCLENBQUFBLE1BQVAsQ0FDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBHcmFwaFZlcnRleCBmcm9tICcuLi8uLi8uLi9kYXRhLXN0cnVjdHVyZXMvZ3JhcGgvR3JhcGhWZXJ0ZXgnO1xuXG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyW11bXX0gYWRqYWNlbmN5TWF0cml4XG4gKiBAcGFyYW0ge29iamVjdH0gdmVydGljZXNJbmRpY2VzXG4gKiBAcGFyYW0ge0dyYXBoVmVydGV4W119IGN5Y2xlXG4gKiBAcGFyYW0ge0dyYXBoVmVydGV4fSB2ZXJ0ZXhDYW5kaWRhdGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2FmZShhZGphY2VuY3lNYXRyaXgsIHZlcnRpY2VzSW5kaWNlcywgY3ljbGUsIHZlcnRleENhbmRpZGF0ZSkge1xuICBjb25zdCBlbmRWZXJ0ZXggPSBjeWNsZVtjeWNsZS5sZW5ndGggLSAxXTtcblxuICAvLyBHZXQgZW5kIGFuZCBjYW5kaWRhdGUgdmVydGljZXMgaW5kaWNlcyBpbiBhZGphY2VuY3kgbWF0cml4LlxuICBjb25zdCBjYW5kaWRhdGVWZXJ0ZXhBZGphY2VuY3lJbmRleCA9IHZlcnRpY2VzSW5kaWNlc1t2ZXJ0ZXhDYW5kaWRhdGUuZ2V0S2V5KCldO1xuICBjb25zdCBlbmRWZXJ0ZXhBZGphY2VuY3lJbmRleCA9IHZlcnRpY2VzSW5kaWNlc1tlbmRWZXJ0ZXguZ2V0S2V5KCldO1xuXG4gIC8vIENoZWNrIGlmIGxhc3QgdmVydGV4IGluIHRoZSBwYXRoIGFuZCBjYW5kaWRhdGUgdmVydGV4IGFyZSBhZGphY2VudC5cbiAgaWYgKGFkamFjZW5jeU1hdHJpeFtlbmRWZXJ0ZXhBZGphY2VuY3lJbmRleF1bY2FuZGlkYXRlVmVydGV4QWRqYWNlbmN5SW5kZXhdID09PSBJbmZpbml0eSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHZlcnRleENhbmRpZGF0ZSBpcyBiZWluZyBhZGRlZCB0byB0aGUgcGF0aCBmb3IgdGhlIGZpcnN0IHRpbWUuXG4gIGNvbnN0IGNhbmRpZGF0ZUR1cGxpY2F0ZSA9IGN5Y2xlLmZpbmQodmVydGV4ID0+IHZlcnRleC5nZXRLZXkoKSA9PT0gdmVydGV4Q2FuZGlkYXRlLmdldEtleSgpKTtcblxuICByZXR1cm4gIWNhbmRpZGF0ZUR1cGxpY2F0ZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge251bWJlcltdW119IGFkamFjZW5jeU1hdHJpeFxuICogQHBhcmFtIHtvYmplY3R9IHZlcnRpY2VzSW5kaWNlc1xuICogQHBhcmFtIHtHcmFwaFZlcnRleFtdfSBjeWNsZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNDeWNsZShhZGphY2VuY3lNYXRyaXgsIHZlcnRpY2VzSW5kaWNlcywgY3ljbGUpIHtcbiAgLy8gQ2hlY2sgaWYgZmlyc3QgYW5kIGxhc3QgdmVydGljZXMgaW4gaGFtaWx0b25pYW4gcGF0aCBhcmUgYWRqYWNlbnQuXG5cbiAgLy8gR2V0IHN0YXJ0IGFuZCBlbmQgdmVydGljZXMgZnJvbSB0aGUgcGF0aC5cbiAgY29uc3Qgc3RhcnRWZXJ0ZXggPSBjeWNsZVswXTtcbiAgY29uc3QgZW5kVmVydGV4ID0gY3ljbGVbY3ljbGUubGVuZ3RoIC0gMV07XG5cbiAgLy8gR2V0IHN0YXJ0L2VuZCB2ZXJ0aWNlcyBpbmRpY2VzIGluIGFkamFjZW5jeSBtYXRyaXguXG4gIGNvbnN0IHN0YXJ0VmVydGV4QWRqYWNlbmN5SW5kZXggPSB2ZXJ0aWNlc0luZGljZXNbc3RhcnRWZXJ0ZXguZ2V0S2V5KCldO1xuICBjb25zdCBlbmRWZXJ0ZXhBZGphY2VuY3lJbmRleCA9IHZlcnRpY2VzSW5kaWNlc1tlbmRWZXJ0ZXguZ2V0S2V5KCldO1xuXG4gIC8vIENoZWNrIGlmIHdlIGNhbiBnbyBmcm9tIGVuZCB2ZXJ0ZXggdG8gdGhlIHN0YXJ0IG9uZS5cbiAgcmV0dXJuIGFkamFjZW5jeU1hdHJpeFtlbmRWZXJ0ZXhBZGphY2VuY3lJbmRleF1bc3RhcnRWZXJ0ZXhBZGphY2VuY3lJbmRleF0gIT09IEluZmluaXR5O1xufVxuXG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyW11bXX0gYWRqYWNlbmN5TWF0cml4XG4gKiBAcGFyYW0ge0dyYXBoVmVydGV4W119IHZlcnRpY2VzXG4gKiBAcGFyYW0ge29iamVjdH0gdmVydGljZXNJbmRpY2VzXG4gKiBAcGFyYW0ge0dyYXBoVmVydGV4W11bXX0gY3ljbGVzXG4gKiBAcGFyYW0ge0dyYXBoVmVydGV4W119IGN5Y2xlXG4gKi9cbmZ1bmN0aW9uIGhhbWlsdG9uaWFuQ3ljbGVSZWN1cnNpdmUoe1xuICBhZGphY2VuY3lNYXRyaXgsXG4gIHZlcnRpY2VzLFxuICB2ZXJ0aWNlc0luZGljZXMsXG4gIGN5Y2xlcyxcbiAgY3ljbGUsXG59KSB7XG4gIC8vIENsb25lIGN5Y2xlIGluIG9yZGVyIHRvIHByZXZlbnQgaXQgZnJvbSBtb2RpZmljYXRpb24gYnkgb3RoZXIgREZTIGJyYW5jaGVzLlxuICBjb25zdCBjdXJyZW50Q3ljbGUgPSBbLi4uY3ljbGVdLm1hcCh2ZXJ0ZXggPT4gbmV3IEdyYXBoVmVydGV4KHZlcnRleC52YWx1ZSkpO1xuXG4gIGlmICh2ZXJ0aWNlcy5sZW5ndGggPT09IGN1cnJlbnRDeWNsZS5sZW5ndGgpIHtcbiAgICAvLyBIYW1pbHRvbmlhbiBwYXRoIGlzIGZvdW5kLlxuICAgIC8vIE5vdyB3ZSBuZWVkIHRvIGNoZWNrIGlmIGl0IGlzIGN5Y2xlIG9yIG5vdC5cbiAgICBpZiAoaXNDeWNsZShhZGphY2VuY3lNYXRyaXgsIHZlcnRpY2VzSW5kaWNlcywgY3VycmVudEN5Y2xlKSkge1xuICAgICAgLy8gQW5vdGhlciBzb2x1dGlvbiBoYXMgYmVlbiBmb3VuZC4gU2F2ZSBpdC5cbiAgICAgIGN5Y2xlcy5wdXNoKGN1cnJlbnRDeWNsZSk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIGZvciAobGV0IHZlcnRleEluZGV4ID0gMDsgdmVydGV4SW5kZXggPCB2ZXJ0aWNlcy5sZW5ndGg7IHZlcnRleEluZGV4ICs9IDEpIHtcbiAgICAvLyBHZXQgdmVydGV4IGNhbmRpZGF0ZSB0aGF0IHdlIHdpbGwgdHJ5IHRvIHB1dCBpbnRvIG5leHQgcGF0aCBzdGVwIGFuZCBzZWUgaWYgaXQgZml0cy5cbiAgICBjb25zdCB2ZXJ0ZXhDYW5kaWRhdGUgPSB2ZXJ0aWNlc1t2ZXJ0ZXhJbmRleF07XG5cbiAgICAvLyBDaGVjayBpZiBpdCBpcyBzYWZlIHRvIHB1dCB2ZXJ0ZXggY2FuZGlkYXRlIHRvIGN5Y2xlLlxuICAgIGlmIChpc1NhZmUoYWRqYWNlbmN5TWF0cml4LCB2ZXJ0aWNlc0luZGljZXMsIGN1cnJlbnRDeWNsZSwgdmVydGV4Q2FuZGlkYXRlKSkge1xuICAgICAgLy8gQWRkIGNhbmRpZGF0ZSB2ZXJ0ZXggdG8gY3ljbGUgcGF0aC5cbiAgICAgIGN1cnJlbnRDeWNsZS5wdXNoKHZlcnRleENhbmRpZGF0ZSk7XG5cbiAgICAgIC8vIFRyeSB0byBmaW5kIG90aGVyIHZlcnRpY2VzIGluIGN5Y2xlLlxuICAgICAgaGFtaWx0b25pYW5DeWNsZVJlY3Vyc2l2ZSh7XG4gICAgICAgIGFkamFjZW5jeU1hdHJpeCxcbiAgICAgICAgdmVydGljZXMsXG4gICAgICAgIHZlcnRpY2VzSW5kaWNlcyxcbiAgICAgICAgY3ljbGVzLFxuICAgICAgICBjeWNsZTogY3VycmVudEN5Y2xlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEJBQ0tUUkFDS0lORy5cbiAgICAgIC8vIFJlbW92ZSBjYW5kaWRhdGUgdmVydGV4IGZyb20gY3ljbGUgcGF0aCBpbiBvcmRlciB0byB0cnkgYW5vdGhlciBvbmUuXG4gICAgICBjdXJyZW50Q3ljbGUucG9wKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtHcmFwaH0gZ3JhcGhcbiAqIEByZXR1cm4ge0dyYXBoVmVydGV4W11bXX1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaGFtaWx0b25pYW5DeWNsZShncmFwaCkge1xuICAvLyBHYXRoZXIgc29tZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZ3JhcGggdGhhdCB3ZSB3aWxsIG5lZWQgdG8gZHVyaW5nXG4gIC8vIHRoZSBwcm9ibGVtIHNvbHZpbmcuXG4gIGNvbnN0IHZlcnRpY2VzSW5kaWNlcyA9IGdyYXBoLmdldFZlcnRpY2VzSW5kaWNlcygpO1xuICBjb25zdCBhZGphY2VuY3lNYXRyaXggPSBncmFwaC5nZXRBZGphY2VuY3lNYXRyaXgoKTtcbiAgY29uc3QgdmVydGljZXMgPSBncmFwaC5nZXRBbGxWZXJ0aWNlcygpO1xuXG4gIC8vIERlZmluZSBzdGFydCB2ZXJ0ZXguIFdlIHdpbGwgYWx3YXlzIHBpY2sgdGhlIGZpcnN0IG9uZVxuICAvLyB0aGlzIGl0IGRvZXNuJ3QgbWF0dGVyIHdoaWNoIHZlcnRleCB0byBwaWNrIGluIGEgY3ljbGUuXG4gIC8vIEV2ZXJ5IHZlcnRleCBpcyBpbiBhIGN5Y2xlIHNvIHdlIGNhbiBzdGFydCBmcm9tIGFueSBvZiB0aGVtLlxuICBjb25zdCBzdGFydFZlcnRleCA9IHZlcnRpY2VzWzBdO1xuXG4gIC8vIEluaXQgY3ljbGVzIGFycmF5IHRoYXQgd2lsbCBob2xkIGFsbCBzb2x1dGlvbnMuXG4gIGNvbnN0IGN5Y2xlcyA9IFtdO1xuXG4gIC8vIEluaXQgY3ljbGUgYXJyYXkgdGhhdCB3aWxsIGhvbGQgY3VycmVudCBjeWNsZSBwYXRoLlxuICBjb25zdCBjeWNsZSA9IFtzdGFydFZlcnRleF07XG5cbiAgLy8gVHJ5IHRvIGZpbmQgY3ljbGVzIHJlY3Vyc2l2ZWx5IGluIERlcHRoIEZpcnN0IFNlYXJjaCBvcmRlci5cbiAgaGFtaWx0b25pYW5DeWNsZVJlY3Vyc2l2ZSh7XG4gICAgYWRqYWNlbmN5TWF0cml4LFxuICAgIHZlcnRpY2VzLFxuICAgIHZlcnRpY2VzSW5kaWNlcyxcbiAgICBjeWNsZXMsXG4gICAgY3ljbGUsXG4gIH0pO1xuXG4gIC8vIFJldHVybiBmb3VuZCBjeWNsZXMuXG4gIHJldHVybiBjeWNsZXM7XG59XG4iXX0=