var cov_25ul7h575u=function(){var path="/Users/hb/latlib/jsserver/javascript-algorithms/src/data-structures/heap/Heap.js";var hash="159c9322945972583f61d3c5799fbff0387cc345";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/hb/latlib/jsserver/javascript-algorithms/src/data-structures/heap/Heap.js",statementMap:{"0":{start:{line:12,column:4},end:{line:14,column:5}},"1":{start:{line:13,column:6},end:{line:13,column:69}},"2":{start:{line:17,column:4},end:{line:17,column:28}},"3":{start:{line:18,column:4},end:{line:18,column:54}},"4":{start:{line:26,column:4},end:{line:26,column:33}},"5":{start:{line:34,column:4},end:{line:34,column:33}},"6":{start:{line:42,column:4},end:{line:42,column:44}},"7":{start:{line:50,column:4},end:{line:50,column:48}},"8":{start:{line:58,column:4},end:{line:58,column:75}},"9":{start:{line:66,column:4},end:{line:66,column:76}},"10":{start:{line:74,column:4},end:{line:74,column:67}},"11":{start:{line:82,column:4},end:{line:82,column:68}},"12":{start:{line:90,column:4},end:{line:90,column:63}},"13":{start:{line:98,column:16},end:{line:98,column:44}},"14":{start:{line:99,column:4},end:{line:99,column:64}},"15":{start:{line:100,column:4},end:{line:100,column:39}},"16":{start:{line:107,column:4},end:{line:109,column:5}},"17":{start:{line:108,column:6},end:{line:108,column:18}},"18":{start:{line:111,column:4},end:{line:111,column:33}},"19":{start:{line:118,column:4},end:{line:120,column:5}},"20":{start:{line:119,column:6},end:{line:119,column:18}},"21":{start:{line:122,column:4},end:{line:124,column:5}},"22":{start:{line:123,column:6},end:{line:123,column:38}},"23":{start:{line:126,column:17},end:{line:126,column:38}},"24":{start:{line:129,column:4},end:{line:129,column:53}},"25":{start:{line:130,column:4},end:{line:130,column:23}},"26":{start:{line:132,column:4},end:{line:132,column:16}},"27":{start:{line:140,column:4},end:{line:140,column:34}},"28":{start:{line:141,column:4},end:{line:141,column:21}},"29":{start:{line:142,column:4},end:{line:142,column:16}},"30":{start:{line:152,column:34},end:{line:152,column:68}},"31":{start:{line:154,column:4},end:{line:184,column:5}},"32":{start:{line:154,column:25},end:{line:154,column:26}},"33":{start:{line:157,column:28},end:{line:157,column:61}},"34":{start:{line:161,column:6},end:{line:183,column:7}},"35":{start:{line:162,column:8},end:{line:162,column:33}},"36":{start:{line:165,column:8},end:{line:165,column:69}},"37":{start:{line:168,column:27},end:{line:168,column:53}},"38":{start:{line:172,column:8},end:{line:182,column:9}},"39":{start:{line:179,column:10},end:{line:179,column:42}},"40":{start:{line:181,column:10},end:{line:181,column:40}},"41":{start:{line:186,column:4},end:{line:186,column:16}},"42":{start:{line:195,column:29},end:{line:195,column:31}},"43":{start:{line:197,column:4},end:{line:201,column:5}},"44":{start:{line:197,column:25},end:{line:197,column:26}},"45":{start:{line:198,column:6},end:{line:200,column:7}},"46":{start:{line:199,column:8},end:{line:199,column:41}},"47":{start:{line:203,column:4},end:{line:203,column:28}},"48":{start:{line:210,column:4},end:{line:210,column:38}},"49":{start:{line:217,column:4},end:{line:217,column:41}},"50":{start:{line:227,column:23},end:{line:227,column:72}},"51":{start:{line:229,column:4},end:{line:235,column:5}},"52":{start:{line:233,column:6},end:{line:233,column:65}},"53":{start:{line:234,column:6},end:{line:234,column:55}},"54":{start:{line:245,column:23},end:{line:245,column:39}},"55":{start:{line:246,column:20},end:{line:246,column:24}},"56":{start:{line:248,column:4},end:{line:267,column:5}},"57":{start:{line:249,column:6},end:{line:256,column:7}},"58":{start:{line:253,column:8},end:{line:253,column:58}},"59":{start:{line:255,column:8},end:{line:255,column:57}},"60":{start:{line:258,column:6},end:{line:263,column:7}},"61":{start:{line:262,column:8},end:{line:262,column:14}},"62":{start:{line:265,column:6},end:{line:265,column:41}},"63":{start:{line:266,column:6},end:{line:266,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:2},end:{line:11,column:3}},loc:{start:{line:11,column:34},end:{line:19,column:3}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:2},end:{line:25,column:3}},loc:{start:{line:25,column:33},end:{line:27,column:3}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:33,column:2},end:{line:33,column:3}},loc:{start:{line:33,column:34},end:{line:35,column:3}},line:33},"3":{name:"(anonymous_3)",decl:{start:{line:41,column:2},end:{line:41,column:3}},loc:{start:{line:41,column:29},end:{line:43,column:3}},line:41},"4":{name:"(anonymous_4)",decl:{start:{line:49,column:2},end:{line:49,column:3}},loc:{start:{line:49,column:24},end:{line:51,column:3}},line:49},"5":{name:"(anonymous_5)",decl:{start:{line:57,column:2},end:{line:57,column:3}},loc:{start:{line:57,column:28},end:{line:59,column:3}},line:57},"6":{name:"(anonymous_6)",decl:{start:{line:65,column:2},end:{line:65,column:3}},loc:{start:{line:65,column:29},end:{line:67,column:3}},line:65},"7":{name:"(anonymous_7)",decl:{start:{line:73,column:2},end:{line:73,column:3}},loc:{start:{line:73,column:25},end:{line:75,column:3}},line:73},"8":{name:"(anonymous_8)",decl:{start:{line:81,column:2},end:{line:81,column:3}},loc:{start:{line:81,column:26},end:{line:83,column:3}},line:81},"9":{name:"(anonymous_9)",decl:{start:{line:89,column:2},end:{line:89,column:3}},loc:{start:{line:89,column:21},end:{line:91,column:3}},line:89},"10":{name:"(anonymous_10)",decl:{start:{line:97,column:2},end:{line:97,column:3}},loc:{start:{line:97,column:27},end:{line:101,column:3}},line:97},"11":{name:"(anonymous_11)",decl:{start:{line:106,column:2},end:{line:106,column:3}},loc:{start:{line:106,column:9},end:{line:112,column:3}},line:106},"12":{name:"(anonymous_12)",decl:{start:{line:117,column:2},end:{line:117,column:3}},loc:{start:{line:117,column:9},end:{line:133,column:3}},line:117},"13":{name:"(anonymous_13)",decl:{start:{line:139,column:2},end:{line:139,column:3}},loc:{start:{line:139,column:12},end:{line:143,column:3}},line:139},"14":{name:"(anonymous_14)",decl:{start:{line:150,column:2},end:{line:150,column:3}},loc:{start:{line:150,column:42},end:{line:187,column:3}},line:150},"15":{name:"(anonymous_15)",decl:{start:{line:194,column:2},end:{line:194,column:3}},loc:{start:{line:194,column:40},end:{line:204,column:3}},line:194},"16":{name:"(anonymous_16)",decl:{start:{line:209,column:2},end:{line:209,column:3}},loc:{start:{line:209,column:12},end:{line:211,column:3}},line:209},"17":{name:"(anonymous_17)",decl:{start:{line:216,column:2},end:{line:216,column:3}},loc:{start:{line:216,column:13},end:{line:218,column:3}},line:216},"18":{name:"(anonymous_18)",decl:{start:{line:223,column:2},end:{line:223,column:3}},loc:{start:{line:223,column:30},end:{line:236,column:3}},line:223},"19":{name:"(anonymous_19)",decl:{start:{line:241,column:2},end:{line:241,column:3}},loc:{start:{line:241,column:36},end:{line:268,column:3}},line:241}},branchMap:{"0":{loc:{start:{line:12,column:4},end:{line:14,column:5}},type:"if",locations:[{start:{line:12,column:4},end:{line:14,column:5}},{start:{line:12,column:4},end:{line:14,column:5}}],line:12},"1":{loc:{start:{line:107,column:4},end:{line:109,column:5}},type:"if",locations:[{start:{line:107,column:4},end:{line:109,column:5}},{start:{line:107,column:4},end:{line:109,column:5}}],line:107},"2":{loc:{start:{line:118,column:4},end:{line:120,column:5}},type:"if",locations:[{start:{line:118,column:4},end:{line:120,column:5}},{start:{line:118,column:4},end:{line:120,column:5}}],line:118},"3":{loc:{start:{line:122,column:4},end:{line:124,column:5}},type:"if",locations:[{start:{line:122,column:4},end:{line:124,column:5}},{start:{line:122,column:4},end:{line:124,column:5}}],line:122},"4":{loc:{start:{line:150,column:15},end:{line:150,column:40}},type:"default-arg",locations:[{start:{line:150,column:28},end:{line:150,column:40}}],line:150},"5":{loc:{start:{line:161,column:6},end:{line:183,column:7}},type:"if",locations:[{start:{line:161,column:6},end:{line:183,column:7}},{start:{line:161,column:6},end:{line:183,column:7}}],line:161},"6":{loc:{start:{line:172,column:8},end:{line:182,column:9}},type:"if",locations:[{start:{line:172,column:8},end:{line:182,column:9}},{start:{line:172,column:8},end:{line:182,column:9}}],line:172},"7":{loc:{start:{line:173,column:10},end:{line:177,column:11}},type:"binary-expr",locations:[{start:{line:173,column:10},end:{line:173,column:42}},{start:{line:175,column:12},end:{line:175,column:23}},{start:{line:176,column:15},end:{line:176,column:87}}],line:173},"8":{loc:{start:{line:194,column:13},end:{line:194,column:38}},type:"default-arg",locations:[{start:{line:194,column:26},end:{line:194,column:38}}],line:194},"9":{loc:{start:{line:198,column:6},end:{line:200,column:7}},type:"if",locations:[{start:{line:198,column:6},end:{line:200,column:7}},{start:{line:198,column:6},end:{line:200,column:7}}],line:198},"10":{loc:{start:{line:227,column:23},end:{line:227,column:72}},type:"binary-expr",locations:[{start:{line:227,column:23},end:{line:227,column:39}},{start:{line:227,column:43},end:{line:227,column:72}}],line:227},"11":{loc:{start:{line:230,column:6},end:{line:231,column:96}},type:"binary-expr",locations:[{start:{line:230,column:6},end:{line:230,column:34}},{start:{line:231,column:9},end:{line:231,column:96}}],line:230},"12":{loc:{start:{line:241,column:14},end:{line:241,column:34}},type:"default-arg",locations:[{start:{line:241,column:33},end:{line:241,column:34}}],line:241},"13":{loc:{start:{line:249,column:6},end:{line:256,column:7}},type:"if",locations:[{start:{line:249,column:6},end:{line:256,column:7}},{start:{line:249,column:6},end:{line:256,column:7}}],line:249},"14":{loc:{start:{line:250,column:8},end:{line:251,column:97}},type:"binary-expr",locations:[{start:{line:250,column:8},end:{line:250,column:40}},{start:{line:251,column:11},end:{line:251,column:97}}],line:250},"15":{loc:{start:{line:258,column:6},end:{line:263,column:7}},type:"if",locations:[{start:{line:258,column:6},end:{line:263,column:7}},{start:{line:258,column:6},end:{line:263,column:7}}],line:258}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0],"13":[0,0],"14":[0,0],"15":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"159c9322945972583f61d3c5799fbff0387cc345"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();import Comparator from'../../utils/comparator/Comparator';/**
 * Parent class for Min and Max Heaps.
 */export default class Heap{/**
   * @constructs Heap
   * @param {Function} [comparatorFunction]
   */constructor(comparatorFunction){cov_25ul7h575u.f[0]++;cov_25ul7h575u.s[0]++;if(new.target===Heap){cov_25ul7h575u.b[0][0]++;cov_25ul7h575u.s[1]++;throw new TypeError('Cannot construct Heap instance directly');}else{cov_25ul7h575u.b[0][1]++;}// Array representation of the heap.
cov_25ul7h575u.s[2]++;this.heapContainer=[];cov_25ul7h575u.s[3]++;this.compare=new Comparator(comparatorFunction);}/**
   * @param {number} parentIndex
   * @return {number}
   */getLeftChildIndex(parentIndex){cov_25ul7h575u.f[1]++;cov_25ul7h575u.s[4]++;return 2*parentIndex+1;}/**
   * @param {number} parentIndex
   * @return {number}
   */getRightChildIndex(parentIndex){cov_25ul7h575u.f[2]++;cov_25ul7h575u.s[5]++;return 2*parentIndex+2;}/**
   * @param {number} childIndex
   * @return {number}
   */getParentIndex(childIndex){cov_25ul7h575u.f[3]++;cov_25ul7h575u.s[6]++;return Math.floor((childIndex-1)/2);}/**
   * @param {number} childIndex
   * @return {boolean}
   */hasParent(childIndex){cov_25ul7h575u.f[4]++;cov_25ul7h575u.s[7]++;return this.getParentIndex(childIndex)>=0;}/**
   * @param {number} parentIndex
   * @return {boolean}
   */hasLeftChild(parentIndex){cov_25ul7h575u.f[5]++;cov_25ul7h575u.s[8]++;return this.getLeftChildIndex(parentIndex)<this.heapContainer.length;}/**
   * @param {number} parentIndex
   * @return {boolean}
   */hasRightChild(parentIndex){cov_25ul7h575u.f[6]++;cov_25ul7h575u.s[9]++;return this.getRightChildIndex(parentIndex)<this.heapContainer.length;}/**
   * @param {number} parentIndex
   * @return {*}
   */leftChild(parentIndex){cov_25ul7h575u.f[7]++;cov_25ul7h575u.s[10]++;return this.heapContainer[this.getLeftChildIndex(parentIndex)];}/**
   * @param {number} parentIndex
   * @return {*}
   */rightChild(parentIndex){cov_25ul7h575u.f[8]++;cov_25ul7h575u.s[11]++;return this.heapContainer[this.getRightChildIndex(parentIndex)];}/**
   * @param {number} childIndex
   * @return {*}
   */parent(childIndex){cov_25ul7h575u.f[9]++;cov_25ul7h575u.s[12]++;return this.heapContainer[this.getParentIndex(childIndex)];}/**
   * @param {number} indexOne
   * @param {number} indexTwo
   */swap(indexOne,indexTwo){cov_25ul7h575u.f[10]++;const tmp=(cov_25ul7h575u.s[13]++,this.heapContainer[indexTwo]);cov_25ul7h575u.s[14]++;this.heapContainer[indexTwo]=this.heapContainer[indexOne];cov_25ul7h575u.s[15]++;this.heapContainer[indexOne]=tmp;}/**
   * @return {*}
   */peek(){cov_25ul7h575u.f[11]++;cov_25ul7h575u.s[16]++;if(this.heapContainer.length===0){cov_25ul7h575u.b[1][0]++;cov_25ul7h575u.s[17]++;return null;}else{cov_25ul7h575u.b[1][1]++;}cov_25ul7h575u.s[18]++;return this.heapContainer[0];}/**
   * @return {*}
   */poll(){cov_25ul7h575u.f[12]++;cov_25ul7h575u.s[19]++;if(this.heapContainer.length===0){cov_25ul7h575u.b[2][0]++;cov_25ul7h575u.s[20]++;return null;}else{cov_25ul7h575u.b[2][1]++;}cov_25ul7h575u.s[21]++;if(this.heapContainer.length===1){cov_25ul7h575u.b[3][0]++;cov_25ul7h575u.s[22]++;return this.heapContainer.pop();}else{cov_25ul7h575u.b[3][1]++;}const item=(cov_25ul7h575u.s[23]++,this.heapContainer[0]);// Move the last element from the end to the head.
cov_25ul7h575u.s[24]++;this.heapContainer[0]=this.heapContainer.pop();cov_25ul7h575u.s[25]++;this.heapifyDown();cov_25ul7h575u.s[26]++;return item;}/**
   * @param {*} item
   * @return {Heap}
   */add(item){cov_25ul7h575u.f[13]++;cov_25ul7h575u.s[27]++;this.heapContainer.push(item);cov_25ul7h575u.s[28]++;this.heapifyUp();cov_25ul7h575u.s[29]++;return this;}/**
   * @param {*} item
   * @param {Comparator} [comparator]
   * @return {Heap}
   */remove(item,comparator=(cov_25ul7h575u.b[4][0]++,this.compare)){cov_25ul7h575u.f[14]++;// Find number of items to remove.
const numberOfItemsToRemove=(cov_25ul7h575u.s[30]++,this.find(item,comparator).length);cov_25ul7h575u.s[31]++;for(let iteration=(cov_25ul7h575u.s[32]++,0);iteration<numberOfItemsToRemove;iteration+=1){// We need to find item index to remove each time after removal since
// indices are being changed after each heapify process.
const indexToRemove=(cov_25ul7h575u.s[33]++,this.find(item,comparator).pop());// If we need to remove last child in the heap then just remove it.
// There is no need to heapify the heap afterwards.
cov_25ul7h575u.s[34]++;if(indexToRemove===this.heapContainer.length-1){cov_25ul7h575u.b[5][0]++;cov_25ul7h575u.s[35]++;this.heapContainer.pop();}else{cov_25ul7h575u.b[5][1]++;cov_25ul7h575u.s[36]++;// Move last element in heap to the vacant (removed) position.
this.heapContainer[indexToRemove]=this.heapContainer.pop();// Get parent.
const parentItem=(cov_25ul7h575u.s[37]++,this.parent(indexToRemove));// If there is no parent or parent is in correct order with the node
// we're going to delete then heapify down. Otherwise heapify up.
cov_25ul7h575u.s[38]++;if((cov_25ul7h575u.b[7][0]++,this.hasLeftChild(indexToRemove))&&((cov_25ul7h575u.b[7][1]++,!parentItem)||(cov_25ul7h575u.b[7][2]++,this.pairIsInCorrectOrder(parentItem,this.heapContainer[indexToRemove])))){cov_25ul7h575u.b[6][0]++;cov_25ul7h575u.s[39]++;this.heapifyDown(indexToRemove);}else{cov_25ul7h575u.b[6][1]++;cov_25ul7h575u.s[40]++;this.heapifyUp(indexToRemove);}}}cov_25ul7h575u.s[41]++;return this;}/**
   * @param {*} item
   * @param {Comparator} [comparator]
   * @return {Number[]}
   */find(item,comparator=(cov_25ul7h575u.b[8][0]++,this.compare)){cov_25ul7h575u.f[15]++;const foundItemIndices=(cov_25ul7h575u.s[42]++,[]);cov_25ul7h575u.s[43]++;for(let itemIndex=(cov_25ul7h575u.s[44]++,0);itemIndex<this.heapContainer.length;itemIndex+=1){cov_25ul7h575u.s[45]++;if(comparator.equal(item,this.heapContainer[itemIndex])){cov_25ul7h575u.b[9][0]++;cov_25ul7h575u.s[46]++;foundItemIndices.push(itemIndex);}else{cov_25ul7h575u.b[9][1]++;}}cov_25ul7h575u.s[47]++;return foundItemIndices;}/**
   * @return {boolean}
   */isEmpty(){cov_25ul7h575u.f[16]++;cov_25ul7h575u.s[48]++;return!this.heapContainer.length;}/**
   * @return {string}
   */toString(){cov_25ul7h575u.f[17]++;cov_25ul7h575u.s[49]++;return this.heapContainer.toString();}/**
   * @param {number} [customStartIndex]
   */heapifyUp(customStartIndex){cov_25ul7h575u.f[18]++;// Take the last element (last in array or the bottom left in a tree)
// in the heap container and lift it up until it is in the correct
// order with respect to its parent element.
let currentIndex=(cov_25ul7h575u.s[50]++,(cov_25ul7h575u.b[10][0]++,customStartIndex)||(cov_25ul7h575u.b[10][1]++,this.heapContainer.length-1));cov_25ul7h575u.s[51]++;while((cov_25ul7h575u.b[11][0]++,this.hasParent(currentIndex))&&(cov_25ul7h575u.b[11][1]++,!this.pairIsInCorrectOrder(this.parent(currentIndex),this.heapContainer[currentIndex]))){cov_25ul7h575u.s[52]++;this.swap(currentIndex,this.getParentIndex(currentIndex));cov_25ul7h575u.s[53]++;currentIndex=this.getParentIndex(currentIndex);}}/**
   * @param {number} [customStartIndex]
   */heapifyDown(customStartIndex=(cov_25ul7h575u.b[12][0]++,0)){cov_25ul7h575u.f[19]++;// Compare the parent element to its children and swap parent with the appropriate
// child (smallest child for MinHeap, largest child for MaxHeap).
// Do the same for next children after swap.
let currentIndex=(cov_25ul7h575u.s[54]++,customStartIndex);let nextIndex=(cov_25ul7h575u.s[55]++,null);cov_25ul7h575u.s[56]++;while(this.hasLeftChild(currentIndex)){cov_25ul7h575u.s[57]++;if((cov_25ul7h575u.b[14][0]++,this.hasRightChild(currentIndex))&&(cov_25ul7h575u.b[14][1]++,this.pairIsInCorrectOrder(this.rightChild(currentIndex),this.leftChild(currentIndex)))){cov_25ul7h575u.b[13][0]++;cov_25ul7h575u.s[58]++;nextIndex=this.getRightChildIndex(currentIndex);}else{cov_25ul7h575u.b[13][1]++;cov_25ul7h575u.s[59]++;nextIndex=this.getLeftChildIndex(currentIndex);}cov_25ul7h575u.s[60]++;if(this.pairIsInCorrectOrder(this.heapContainer[currentIndex],this.heapContainer[nextIndex])){cov_25ul7h575u.b[15][0]++;cov_25ul7h575u.s[61]++;break;}else{cov_25ul7h575u.b[15][1]++;}cov_25ul7h575u.s[62]++;this.swap(currentIndex,nextIndex);cov_25ul7h575u.s[63]++;currentIndex=nextIndex;}}/**
   * Checks if pair of heap elements is in correct order.
   * For MinHeap the first element must be always smaller or equal.
   * For MaxHeap the first element must be always bigger or equal.
   *
   * @param {*} firstElement
   * @param {*} secondElement
   * @return {boolean}
   */ /* istanbul ignore next */pairIsInCorrectOrder(firstElement,secondElement){throw new Error(`
      You have to implement heap pair comparision method
      for ${firstElement} and ${secondElement} values.
    `);}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYi9sYXRsaWIvanNzZXJ2ZXIvamF2YXNjcmlwdC1hbGdvcml0aG1zL3NyYy9kYXRhLXN0cnVjdHVyZXMvaGVhcC9IZWFwLmpzIl0sIm5hbWVzIjpbIkNvbXBhcmF0b3IiLCJIZWFwIiwiY29uc3RydWN0b3IiLCJjb21wYXJhdG9yRnVuY3Rpb24iLCJuZXciLCJ0YXJnZXQiLCJUeXBlRXJyb3IiLCJoZWFwQ29udGFpbmVyIiwiY29tcGFyZSIsImdldExlZnRDaGlsZEluZGV4IiwicGFyZW50SW5kZXgiLCJnZXRSaWdodENoaWxkSW5kZXgiLCJnZXRQYXJlbnRJbmRleCIsImNoaWxkSW5kZXgiLCJNYXRoIiwiZmxvb3IiLCJoYXNQYXJlbnQiLCJoYXNMZWZ0Q2hpbGQiLCJsZW5ndGgiLCJoYXNSaWdodENoaWxkIiwibGVmdENoaWxkIiwicmlnaHRDaGlsZCIsInBhcmVudCIsInN3YXAiLCJpbmRleE9uZSIsImluZGV4VHdvIiwidG1wIiwicGVlayIsInBvbGwiLCJwb3AiLCJpdGVtIiwiaGVhcGlmeURvd24iLCJhZGQiLCJwdXNoIiwiaGVhcGlmeVVwIiwicmVtb3ZlIiwiY29tcGFyYXRvciIsIm51bWJlck9mSXRlbXNUb1JlbW92ZSIsImZpbmQiLCJpdGVyYXRpb24iLCJpbmRleFRvUmVtb3ZlIiwicGFyZW50SXRlbSIsInBhaXJJc0luQ29ycmVjdE9yZGVyIiwiZm91bmRJdGVtSW5kaWNlcyIsIml0ZW1JbmRleCIsImVxdWFsIiwiaXNFbXB0eSIsInRvU3RyaW5nIiwiY3VzdG9tU3RhcnRJbmRleCIsImN1cnJlbnRJbmRleCIsIm5leHRJbmRleCIsImZpcnN0RWxlbWVudCIsInNlY29uZEVsZW1lbnQiLCJFcnJvciJdLCJtYXBwaW5ncyI6Inc1VkFBQSxNQUFPQSxDQUFBQSxVQUFQLEtBQXVCLG1DQUF2QixDQUVBOztHQUdBLGNBQWUsTUFBTUMsQ0FBQUEsSUFBSyxDQUN4Qjs7O0tBSUFDLFdBQVcsQ0FBQ0Msa0JBQUQsQ0FBcUIsNkNBQzlC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QUZFLENBQUosQ0FHRyxrREFDRCxNQUNELENBTEQsZ0NBVnNDLHVCQWlCdEMsS0FBSzNCLElBQUwsQ0FBVTBCLFlBQVYsQ0FBd0JDLFNBQXhCLEVBakJzQyx1QkFrQnRDRCxZQUFZLENBQUdDLFNBQWYsQ0FDRCxDQUNGLENBRUQ7Ozs7Ozs7O0tBeFF3QixDQWlSeEIsMEJBQ0FSLG9CQUFvQixDQUFDUyxZQUFELENBQWVDLGFBQWYsQ0FBOEIsQ0FDaEQsS0FBTSxJQUFJQyxDQUFBQSxLQUFKLENBQVc7O1lBRVRGLFlBQWEsUUFBT0MsYUFBYztLQUZwQyxDQUFOLENBSUQsQ0F2UnVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENvbXBhcmF0b3IgZnJvbSAnLi4vLi4vdXRpbHMvY29tcGFyYXRvci9Db21wYXJhdG9yJztcblxuLyoqXG4gKiBQYXJlbnQgY2xhc3MgZm9yIE1pbiBhbmQgTWF4IEhlYXBzLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBIZWFwIHtcbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RzIEhlYXBcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmF0b3JGdW5jdGlvbl1cbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbXBhcmF0b3JGdW5jdGlvbikge1xuICAgIGlmIChuZXcudGFyZ2V0ID09PSBIZWFwKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29uc3RydWN0IEhlYXAgaW5zdGFuY2UgZGlyZWN0bHknKTtcbiAgICB9XG5cbiAgICAvLyBBcnJheSByZXByZXNlbnRhdGlvbiBvZiB0aGUgaGVhcC5cbiAgICB0aGlzLmhlYXBDb250YWluZXIgPSBbXTtcbiAgICB0aGlzLmNvbXBhcmUgPSBuZXcgQ29tcGFyYXRvcihjb21wYXJhdG9yRnVuY3Rpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwYXJlbnRJbmRleFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBnZXRMZWZ0Q2hpbGRJbmRleChwYXJlbnRJbmRleCkge1xuICAgIHJldHVybiAoMiAqIHBhcmVudEluZGV4KSArIDE7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IHBhcmVudEluZGV4XG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICovXG4gIGdldFJpZ2h0Q2hpbGRJbmRleChwYXJlbnRJbmRleCkge1xuICAgIHJldHVybiAoMiAqIHBhcmVudEluZGV4KSArIDI7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNoaWxkSW5kZXhcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0UGFyZW50SW5kZXgoY2hpbGRJbmRleCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKChjaGlsZEluZGV4IC0gMSkgLyAyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2hpbGRJbmRleFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaGFzUGFyZW50KGNoaWxkSW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRQYXJlbnRJbmRleChjaGlsZEluZGV4KSA+PSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwYXJlbnRJbmRleFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgaGFzTGVmdENoaWxkKHBhcmVudEluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TGVmdENoaWxkSW5kZXgocGFyZW50SW5kZXgpIDwgdGhpcy5oZWFwQ29udGFpbmVyLmxlbmd0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gcGFyZW50SW5kZXhcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGhhc1JpZ2h0Q2hpbGQocGFyZW50SW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRSaWdodENoaWxkSW5kZXgocGFyZW50SW5kZXgpIDwgdGhpcy5oZWFwQ29udGFpbmVyLmxlbmd0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gcGFyZW50SW5kZXhcbiAgICogQHJldHVybiB7Kn1cbiAgICovXG4gIGxlZnRDaGlsZChwYXJlbnRJbmRleCkge1xuICAgIHJldHVybiB0aGlzLmhlYXBDb250YWluZXJbdGhpcy5nZXRMZWZ0Q2hpbGRJbmRleChwYXJlbnRJbmRleCldO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwYXJlbnRJbmRleFxuICAgKiBAcmV0dXJuIHsqfVxuICAgKi9cbiAgcmlnaHRDaGlsZChwYXJlbnRJbmRleCkge1xuICAgIHJldHVybiB0aGlzLmhlYXBDb250YWluZXJbdGhpcy5nZXRSaWdodENoaWxkSW5kZXgocGFyZW50SW5kZXgpXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gY2hpbGRJbmRleFxuICAgKiBAcmV0dXJuIHsqfVxuICAgKi9cbiAgcGFyZW50KGNoaWxkSW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFwQ29udGFpbmVyW3RoaXMuZ2V0UGFyZW50SW5kZXgoY2hpbGRJbmRleCldO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleE9uZVxuICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXhUd29cbiAgICovXG4gIHN3YXAoaW5kZXhPbmUsIGluZGV4VHdvKSB7XG4gICAgY29uc3QgdG1wID0gdGhpcy5oZWFwQ29udGFpbmVyW2luZGV4VHdvXTtcbiAgICB0aGlzLmhlYXBDb250YWluZXJbaW5kZXhUd29dID0gdGhpcy5oZWFwQ29udGFpbmVyW2luZGV4T25lXTtcbiAgICB0aGlzLmhlYXBDb250YWluZXJbaW5kZXhPbmVdID0gdG1wO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyp9XG4gICAqL1xuICBwZWVrKCkge1xuICAgIGlmICh0aGlzLmhlYXBDb250YWluZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5oZWFwQ29udGFpbmVyWzBdO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyp9XG4gICAqL1xuICBwb2xsKCkge1xuICAgIGlmICh0aGlzLmhlYXBDb250YWluZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5oZWFwQ29udGFpbmVyLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHRoaXMuaGVhcENvbnRhaW5lci5wb3AoKTtcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtID0gdGhpcy5oZWFwQ29udGFpbmVyWzBdO1xuXG4gICAgLy8gTW92ZSB0aGUgbGFzdCBlbGVtZW50IGZyb20gdGhlIGVuZCB0byB0aGUgaGVhZC5cbiAgICB0aGlzLmhlYXBDb250YWluZXJbMF0gPSB0aGlzLmhlYXBDb250YWluZXIucG9wKCk7XG4gICAgdGhpcy5oZWFwaWZ5RG93bigpO1xuXG4gICAgcmV0dXJuIGl0ZW07XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHsqfSBpdGVtXG4gICAqIEByZXR1cm4ge0hlYXB9XG4gICAqL1xuICBhZGQoaXRlbSkge1xuICAgIHRoaXMuaGVhcENvbnRhaW5lci5wdXNoKGl0ZW0pO1xuICAgIHRoaXMuaGVhcGlmeVVwKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHsqfSBpdGVtXG4gICAqIEBwYXJhbSB7Q29tcGFyYXRvcn0gW2NvbXBhcmF0b3JdXG4gICAqIEByZXR1cm4ge0hlYXB9XG4gICAqL1xuICByZW1vdmUoaXRlbSwgY29tcGFyYXRvciA9IHRoaXMuY29tcGFyZSkge1xuICAgIC8vIEZpbmQgbnVtYmVyIG9mIGl0ZW1zIHRvIHJlbW92ZS5cbiAgICBjb25zdCBudW1iZXJPZkl0ZW1zVG9SZW1vdmUgPSB0aGlzLmZpbmQoaXRlbSwgY29tcGFyYXRvcikubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaXRlcmF0aW9uID0gMDsgaXRlcmF0aW9uIDwgbnVtYmVyT2ZJdGVtc1RvUmVtb3ZlOyBpdGVyYXRpb24gKz0gMSkge1xuICAgICAgLy8gV2UgbmVlZCB0byBmaW5kIGl0ZW0gaW5kZXggdG8gcmVtb3ZlIGVhY2ggdGltZSBhZnRlciByZW1vdmFsIHNpbmNlXG4gICAgICAvLyBpbmRpY2VzIGFyZSBiZWluZyBjaGFuZ2VkIGFmdGVyIGVhY2ggaGVhcGlmeSBwcm9jZXNzLlxuICAgICAgY29uc3QgaW5kZXhUb1JlbW92ZSA9IHRoaXMuZmluZChpdGVtLCBjb21wYXJhdG9yKS5wb3AoKTtcblxuICAgICAgLy8gSWYgd2UgbmVlZCB0byByZW1vdmUgbGFzdCBjaGlsZCBpbiB0aGUgaGVhcCB0aGVuIGp1c3QgcmVtb3ZlIGl0LlxuICAgICAgLy8gVGhlcmUgaXMgbm8gbmVlZCB0byBoZWFwaWZ5IHRoZSBoZWFwIGFmdGVyd2FyZHMuXG4gICAgICBpZiAoaW5kZXhUb1JlbW92ZSA9PT0gKHRoaXMuaGVhcENvbnRhaW5lci5sZW5ndGggLSAxKSkge1xuICAgICAgICB0aGlzLmhlYXBDb250YWluZXIucG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBNb3ZlIGxhc3QgZWxlbWVudCBpbiBoZWFwIHRvIHRoZSB2YWNhbnQgKHJlbW92ZWQpIHBvc2l0aW9uLlxuICAgICAgICB0aGlzLmhlYXBDb250YWluZXJbaW5kZXhUb1JlbW92ZV0gPSB0aGlzLmhlYXBDb250YWluZXIucG9wKCk7XG5cbiAgICAgICAgLy8gR2V0IHBhcmVudC5cbiAgICAgICAgY29uc3QgcGFyZW50SXRlbSA9IHRoaXMucGFyZW50KGluZGV4VG9SZW1vdmUpO1xuXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHBhcmVudCBvciBwYXJlbnQgaXMgaW4gY29ycmVjdCBvcmRlciB3aXRoIHRoZSBub2RlXG4gICAgICAgIC8vIHdlJ3JlIGdvaW5nIHRvIGRlbGV0ZSB0aGVuIGhlYXBpZnkgZG93bi4gT3RoZXJ3aXNlIGhlYXBpZnkgdXAuXG4gICAgICAgIGlmIChcbiAgICAgICAgICB0aGlzLmhhc0xlZnRDaGlsZChpbmRleFRvUmVtb3ZlKVxuICAgICAgICAgICYmIChcbiAgICAgICAgICAgICFwYXJlbnRJdGVtXG4gICAgICAgICAgICB8fCB0aGlzLnBhaXJJc0luQ29ycmVjdE9yZGVyKHBhcmVudEl0ZW0sIHRoaXMuaGVhcENvbnRhaW5lcltpbmRleFRvUmVtb3ZlXSlcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIHRoaXMuaGVhcGlmeURvd24oaW5kZXhUb1JlbW92ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5oZWFwaWZ5VXAoaW5kZXhUb1JlbW92ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyp9IGl0ZW1cbiAgICogQHBhcmFtIHtDb21wYXJhdG9yfSBbY29tcGFyYXRvcl1cbiAgICogQHJldHVybiB7TnVtYmVyW119XG4gICAqL1xuICBmaW5kKGl0ZW0sIGNvbXBhcmF0b3IgPSB0aGlzLmNvbXBhcmUpIHtcbiAgICBjb25zdCBmb3VuZEl0ZW1JbmRpY2VzID0gW107XG5cbiAgICBmb3IgKGxldCBpdGVtSW5kZXggPSAwOyBpdGVtSW5kZXggPCB0aGlzLmhlYXBDb250YWluZXIubGVuZ3RoOyBpdGVtSW5kZXggKz0gMSkge1xuICAgICAgaWYgKGNvbXBhcmF0b3IuZXF1YWwoaXRlbSwgdGhpcy5oZWFwQ29udGFpbmVyW2l0ZW1JbmRleF0pKSB7XG4gICAgICAgIGZvdW5kSXRlbUluZGljZXMucHVzaChpdGVtSW5kZXgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb3VuZEl0ZW1JbmRpY2VzO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBpc0VtcHR5KCkge1xuICAgIHJldHVybiAhdGhpcy5oZWFwQ29udGFpbmVyLmxlbmd0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFwQ29udGFpbmVyLnRvU3RyaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtjdXN0b21TdGFydEluZGV4XVxuICAgKi9cbiAgaGVhcGlmeVVwKGN1c3RvbVN0YXJ0SW5kZXgpIHtcbiAgICAvLyBUYWtlIHRoZSBsYXN0IGVsZW1lbnQgKGxhc3QgaW4gYXJyYXkgb3IgdGhlIGJvdHRvbSBsZWZ0IGluIGEgdHJlZSlcbiAgICAvLyBpbiB0aGUgaGVhcCBjb250YWluZXIgYW5kIGxpZnQgaXQgdXAgdW50aWwgaXQgaXMgaW4gdGhlIGNvcnJlY3RcbiAgICAvLyBvcmRlciB3aXRoIHJlc3BlY3QgdG8gaXRzIHBhcmVudCBlbGVtZW50LlxuICAgIGxldCBjdXJyZW50SW5kZXggPSBjdXN0b21TdGFydEluZGV4IHx8IHRoaXMuaGVhcENvbnRhaW5lci5sZW5ndGggLSAxO1xuXG4gICAgd2hpbGUgKFxuICAgICAgdGhpcy5oYXNQYXJlbnQoY3VycmVudEluZGV4KVxuICAgICAgJiYgIXRoaXMucGFpcklzSW5Db3JyZWN0T3JkZXIodGhpcy5wYXJlbnQoY3VycmVudEluZGV4KSwgdGhpcy5oZWFwQ29udGFpbmVyW2N1cnJlbnRJbmRleF0pXG4gICAgKSB7XG4gICAgICB0aGlzLnN3YXAoY3VycmVudEluZGV4LCB0aGlzLmdldFBhcmVudEluZGV4KGN1cnJlbnRJbmRleCkpO1xuICAgICAgY3VycmVudEluZGV4ID0gdGhpcy5nZXRQYXJlbnRJbmRleChjdXJyZW50SW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2N1c3RvbVN0YXJ0SW5kZXhdXG4gICAqL1xuICBoZWFwaWZ5RG93bihjdXN0b21TdGFydEluZGV4ID0gMCkge1xuICAgIC8vIENvbXBhcmUgdGhlIHBhcmVudCBlbGVtZW50IHRvIGl0cyBjaGlsZHJlbiBhbmQgc3dhcCBwYXJlbnQgd2l0aCB0aGUgYXBwcm9wcmlhdGVcbiAgICAvLyBjaGlsZCAoc21hbGxlc3QgY2hpbGQgZm9yIE1pbkhlYXAsIGxhcmdlc3QgY2hpbGQgZm9yIE1heEhlYXApLlxuICAgIC8vIERvIHRoZSBzYW1lIGZvciBuZXh0IGNoaWxkcmVuIGFmdGVyIHN3YXAuXG4gICAgbGV0IGN1cnJlbnRJbmRleCA9IGN1c3RvbVN0YXJ0SW5kZXg7XG4gICAgbGV0IG5leHRJbmRleCA9IG51bGw7XG5cbiAgICB3aGlsZSAodGhpcy5oYXNMZWZ0Q2hpbGQoY3VycmVudEluZGV4KSkge1xuICAgICAgaWYgKFxuICAgICAgICB0aGlzLmhhc1JpZ2h0Q2hpbGQoY3VycmVudEluZGV4KVxuICAgICAgICAmJiB0aGlzLnBhaXJJc0luQ29ycmVjdE9yZGVyKHRoaXMucmlnaHRDaGlsZChjdXJyZW50SW5kZXgpLCB0aGlzLmxlZnRDaGlsZChjdXJyZW50SW5kZXgpKVxuICAgICAgKSB7XG4gICAgICAgIG5leHRJbmRleCA9IHRoaXMuZ2V0UmlnaHRDaGlsZEluZGV4KGN1cnJlbnRJbmRleCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0SW5kZXggPSB0aGlzLmdldExlZnRDaGlsZEluZGV4KGN1cnJlbnRJbmRleCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnBhaXJJc0luQ29ycmVjdE9yZGVyKFxuICAgICAgICB0aGlzLmhlYXBDb250YWluZXJbY3VycmVudEluZGV4XSxcbiAgICAgICAgdGhpcy5oZWFwQ29udGFpbmVyW25leHRJbmRleF0sXG4gICAgICApKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnN3YXAoY3VycmVudEluZGV4LCBuZXh0SW5kZXgpO1xuICAgICAgY3VycmVudEluZGV4ID0gbmV4dEluZGV4O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgcGFpciBvZiBoZWFwIGVsZW1lbnRzIGlzIGluIGNvcnJlY3Qgb3JkZXIuXG4gICAqIEZvciBNaW5IZWFwIHRoZSBmaXJzdCBlbGVtZW50IG11c3QgYmUgYWx3YXlzIHNtYWxsZXIgb3IgZXF1YWwuXG4gICAqIEZvciBNYXhIZWFwIHRoZSBmaXJzdCBlbGVtZW50IG11c3QgYmUgYWx3YXlzIGJpZ2dlciBvciBlcXVhbC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBmaXJzdEVsZW1lbnRcbiAgICogQHBhcmFtIHsqfSBzZWNvbmRFbGVtZW50XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBwYWlySXNJbkNvcnJlY3RPcmRlcihmaXJzdEVsZW1lbnQsIHNlY29uZEVsZW1lbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFxuICAgICAgWW91IGhhdmUgdG8gaW1wbGVtZW50IGhlYXAgcGFpciBjb21wYXJpc2lvbiBtZXRob2RcbiAgICAgIGZvciAke2ZpcnN0RWxlbWVudH0gYW5kICR7c2Vjb25kRWxlbWVudH0gdmFsdWVzLlxuICAgIGApO1xuICB9XG59XG4iXX0=