var cov_7wahjtauu=function(){var path="/Users/hb/latlib/jsserver/javascript-algorithms/src/algorithms/graph/bridges/graphBridges.js";var hash="47b06b07c9ec820d009b14d5238d65fb92d52e87";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/hb/latlib/jsserver/javascript-algorithms/src/algorithms/graph/bridges/graphBridges.js",statementMap:{"0":{start:{line:8,column:4},end:{line:8,column:39}},"1":{start:{line:9,column:4},end:{line:9,column:45}},"2":{start:{line:19,column:21},end:{line:19,column:23}},"3":{start:{line:22,column:18},end:{line:22,column:20}},"4":{start:{line:25,column:22},end:{line:25,column:23}},"5":{start:{line:28,column:22},end:{line:28,column:47}},"6":{start:{line:30,column:23},end:{line:89,column:3}},"7":{start:{line:36,column:6},end:{line:36,column:25}},"8":{start:{line:39,column:6},end:{line:42,column:9}},"9":{start:{line:49,column:6},end:{line:52,column:7}},"10":{start:{line:51,column:8},end:{line:51,column:15}},"11":{start:{line:55,column:6},end:{line:67,column:10}},"12":{start:{line:56,column:33},end:{line:56,column:83}},"13":{start:{line:63,column:36},end:{line:63,column:82}},"14":{start:{line:64,column:12},end:{line:64,column:97}},"15":{start:{line:71,column:38},end:{line:71,column:89}},"16":{start:{line:72,column:39},end:{line:72,column:91}},"17":{start:{line:73,column:6},end:{line:75,column:7}},"18":{start:{line:74,column:8},end:{line:74,column:87}},"19":{start:{line:80,column:34},end:{line:80,column:83}},"20":{start:{line:81,column:6},end:{line:84,column:7}},"21":{start:{line:82,column:23},end:{line:82,column:68}},"22":{start:{line:83,column:8},end:{line:83,column:42}},"23":{start:{line:87,column:6},end:{line:87,column:46}},"24":{start:{line:92,column:2},end:{line:92,column:53}},"25":{start:{line:94,column:2},end:{line:94,column:17}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:2},end:{line:7,column:3}},loc:{start:{line:7,column:51},end:{line:10,column:3}},line:7},"1":{name:"graphBridges",decl:{start:{line:17,column:24},end:{line:17,column:36}},loc:{start:{line:17,column:44},end:{line:95,column:1}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:34,column:17},end:{line:34,column:18}},loc:{start:{line:34,column:40},end:{line:43,column:5}},line:34},"3":{name:"(anonymous_3)",decl:{start:{line:48,column:17},end:{line:48,column:18}},loc:{start:{line:48,column:56},end:{line:85,column:5}},line:48},"4":{name:"(anonymous_4)",decl:{start:{line:56,column:16},end:{line:56,column:17}},loc:{start:{line:56,column:33},end:{line:56,column:83}},line:56},"5":{name:"(anonymous_5)",decl:{start:{line:62,column:10},end:{line:62,column:11}},loc:{start:{line:62,column:45},end:{line:65,column:11}},line:62},"6":{name:"(anonymous_6)",decl:{start:{line:86,column:20},end:{line:86,column:21}},loc:{start:{line:86,column:40},end:{line:88,column:5}},line:86}},branchMap:{"0":{loc:{start:{line:49,column:6},end:{line:52,column:7}},type:"if",locations:[{start:{line:49,column:6},end:{line:52,column:7}},{start:{line:49,column:6},end:{line:52,column:7}}],line:49},"1":{loc:{start:{line:64,column:19},end:{line:64,column:96}},type:"cond-expr",locations:[{start:{line:64,column:59},end:{line:64,column:74}},{start:{line:64,column:77},end:{line:64,column:96}}],line:64},"2":{loc:{start:{line:73,column:6},end:{line:75,column:7}},type:"if",locations:[{start:{line:73,column:6},end:{line:75,column:7}},{start:{line:73,column:6},end:{line:75,column:7}}],line:73},"3":{loc:{start:{line:81,column:6},end:{line:84,column:7}},type:"if",locations:[{start:{line:81,column:6},end:{line:84,column:7}},{start:{line:81,column:6},end:{line:84,column:7}}],line:81}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"47b06b07c9ec820d009b14d5238d65fb92d52e87"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();import depthFirstSearch from'../depth-first-search/depthFirstSearch';/**
 * Helper class for visited vertex metadata.
 */class VisitMetadata{constructor({discoveryTime,lowDiscoveryTime}){cov_7wahjtauu.f[0]++;cov_7wahjtauu.s[0]++;this.discoveryTime=discoveryTime;cov_7wahjtauu.s[1]++;this.lowDiscoveryTime=lowDiscoveryTime;}}/**
 * @param {Graph} graph
 * @return {Object}
 */export default function graphBridges(graph){cov_7wahjtauu.f[1]++;// Set of vertices we've already visited during DFS.
const visitedSet=(cov_7wahjtauu.s[2]++,{});// Set of bridges.
const bridges=(cov_7wahjtauu.s[3]++,{});// Time needed to discover to the current vertex.
let discoveryTime=(cov_7wahjtauu.s[4]++,0);// Peek the start vertex for DFS traversal.
const startVertex=(cov_7wahjtauu.s[5]++,graph.getAllVertices()[0]);const dfsCallbacks=(cov_7wahjtauu.s[6]++,{/**
     * @param {GraphVertex} currentVertex
     */enterVertex:({currentVertex})=>{cov_7wahjtauu.f[2]++;cov_7wahjtauu.s[7]++;// Tick discovery time.
discoveryTime+=1;// Put current vertex to visited set.
cov_7wahjtauu.s[8]++;visitedSet[currentVertex.getKey()]=new VisitMetadata({discoveryTime,lowDiscoveryTime:discoveryTime});},/**
     * @param {GraphVertex} currentVertex
     * @param {GraphVertex} previousVertex
     */leaveVertex:({currentVertex,previousVertex})=>{cov_7wahjtauu.f[3]++;cov_7wahjtauu.s[9]++;if(previousVertex===null){cov_7wahjtauu.b[0][0]++;cov_7wahjtauu.s[10]++;// Don't do anything for the root vertex if it is already current (not previous one).
return;}else{cov_7wahjtauu.b[0][1]++;}// Check if current node is connected to any early node other then previous one.
cov_7wahjtauu.s[11]++;visitedSet[currentVertex.getKey()].lowDiscoveryTime=currentVertex.getNeighbors().filter(earlyNeighbor=>{cov_7wahjtauu.f[4]++;cov_7wahjtauu.s[12]++;return earlyNeighbor.getKey()!==previousVertex.getKey();}).reduce(/**
           * @param {number} lowestDiscoveryTime
           * @param {GraphVertex} neighbor
           */(lowestDiscoveryTime,neighbor)=>{cov_7wahjtauu.f[5]++;const neighborLowTime=(cov_7wahjtauu.s[13]++,visitedSet[neighbor.getKey()].lowDiscoveryTime);cov_7wahjtauu.s[14]++;return neighborLowTime<lowestDiscoveryTime?(cov_7wahjtauu.b[1][0]++,neighborLowTime):(cov_7wahjtauu.b[1][1]++,lowestDiscoveryTime);},visitedSet[currentVertex.getKey()].lowDiscoveryTime);// Compare low discovery times. In case if current low discovery time is less than the one
// in previous vertex then update previous vertex low time.
const currentLowDiscoveryTime=(cov_7wahjtauu.s[15]++,visitedSet[currentVertex.getKey()].lowDiscoveryTime);const previousLowDiscoveryTime=(cov_7wahjtauu.s[16]++,visitedSet[previousVertex.getKey()].lowDiscoveryTime);cov_7wahjtauu.s[17]++;if(currentLowDiscoveryTime<previousLowDiscoveryTime){cov_7wahjtauu.b[2][0]++;cov_7wahjtauu.s[18]++;visitedSet[previousVertex.getKey()].lowDiscoveryTime=currentLowDiscoveryTime;}else{cov_7wahjtauu.b[2][1]++;}// Compare current vertex low discovery time with parent discovery time. Check if there
// are any short path (back edge) exists. If we can't get to current vertex other then
// via parent then the parent vertex is articulation point for current one.
const parentDiscoveryTime=(cov_7wahjtauu.s[19]++,visitedSet[previousVertex.getKey()].discoveryTime);cov_7wahjtauu.s[20]++;if(parentDiscoveryTime<currentLowDiscoveryTime){cov_7wahjtauu.b[3][0]++;const bridge=(cov_7wahjtauu.s[21]++,graph.findEdge(previousVertex,currentVertex));cov_7wahjtauu.s[22]++;bridges[bridge.getKey()]=bridge;}else{cov_7wahjtauu.b[3][1]++;}},allowTraversal:({nextVertex})=>{cov_7wahjtauu.f[6]++;cov_7wahjtauu.s[23]++;return!visitedSet[nextVertex.getKey()];}});// Do Depth First Search traversal over submitted graph.
cov_7wahjtauu.s[24]++;depthFirstSearch(graph,startVertex,dfsCallbacks);cov_7wahjtauu.s[25]++;return bridges;}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYi9sYXRsaWIvanNzZXJ2ZXIvamF2YXNjcmlwdC1hbGdvcml0aG1zL3NyYy9hbGdvcml0aG1zL2dyYXBoL2JyaWRnZXMvZ3JhcGhCcmlkZ2VzLmpzIl0sIm5hbWVzIjpbImRlcHRoRmlyc3RTZWFyY2giLCJWaXNpdE1ldGFkYXRhIiwiY29uc3RydWN0b3IiLCJkaXNjb3ZlcnlUaW1lIiwibG93RGlzY292ZXJ5VGltZSIsImdyYXBoQnJpZGdlcyIsImdyYXBoIiwidmlzaXRlZFNldCIsImJyaWRnZXMiLCJzdGFydFZlcnRleCIsImdldEFsbFZlcnRpY2VzIiwiZGZzQ2FsbGJhY2tzIiwiZW50ZXJWZXJ0ZXgiLCJjdXJyZW50VmVydGV4IiwiZ2V0S2V5IiwibGVhdmVWZXJ0ZXgiLCJwcmV2aW91c1ZlcnRleCIsImdldE5laWdoYm9ycyIsImZpbHRlciIsImVhcmx5TmVpZ2hib3IiLCJyZWR1Y2UiLCJsb3dlc3REaXNjb3ZlcnlUaW1lIiwibmVpZ2hib3IiLCJuZWlnaGJvckxvd1RpbWUiLCJjdXJyZW50TG93RGlzY292ZXJ5VGltZSIsInByZXZpb3VzTG93RGlzY292ZXJ5VGltZSIsInBhcmVudERpc2NvdmVyeVRpbWUiLCJicmlkZ2UiLCJmaW5kRWRnZSIsImFsbG93VHJhdmVyc2FsIiwibmV4dFZlcnRleCJdLCJtYXBwaW5ncyI6IjhrSUFBQSxNQUFPQSxDQUFBQSxnQkFBUCxLQUE2Qix3Q0FBN0IsQ0FFQTs7R0FHQSxLQUFNQyxDQUFBQSxhQUFjLENBQ2xCQyxXQUFXLENBQUMsQ0FBRUMsYUFBRixDQUFpQkMsZ0JBQWpCLENBQUQsQ0FBc0MsMkNBQy9DLEtBQUtELGFBQUwsQ0FBcUJBLGFBQXJCLENBRCtDLHFCQUUvQyxLQUFLQyxnQkFBTCxDQUF3QkEsZ0JBQXhCLENBQ0QsQ0FKaUIsQ0FPcEI7OztHQUlBLGNBQWUsU0FBU0MsQ0FBQUEsWUFBVCxDQUFzQkMsS0FBdEIsQ0FBNkIsc0JBQzFDO0FBQ0EsS0FBTUMsQ0FBQUEsVUFBVSx1QkFB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QixDQUFILENBQWxCLENBNkRBO0FBMUUwQyxzQkEyRTFDZCxnQkFBZ0IsQ0FBQ00sS0FBRCxDQUFRRyxXQUFSLENBQXFCRSxZQUFyQixDQUFoQixDQTNFMEMsc0JBNkUxQyxNQUFPSCxDQUFBQSxPQUFQLENBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVwdGhGaXJzdFNlYXJjaCBmcm9tICcuLi9kZXB0aC1maXJzdC1zZWFyY2gvZGVwdGhGaXJzdFNlYXJjaCc7XG5cbi8qKlxuICogSGVscGVyIGNsYXNzIGZvciB2aXNpdGVkIHZlcnRleCBtZXRhZGF0YS5cbiAqL1xuY2xhc3MgVmlzaXRNZXRhZGF0YSB7XG4gIGNvbnN0cnVjdG9yKHsgZGlzY292ZXJ5VGltZSwgbG93RGlzY292ZXJ5VGltZSB9KSB7XG4gICAgdGhpcy5kaXNjb3ZlcnlUaW1lID0gZGlzY292ZXJ5VGltZTtcbiAgICB0aGlzLmxvd0Rpc2NvdmVyeVRpbWUgPSBsb3dEaXNjb3ZlcnlUaW1lO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtHcmFwaH0gZ3JhcGhcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ3JhcGhCcmlkZ2VzKGdyYXBoKSB7XG4gIC8vIFNldCBvZiB2ZXJ0aWNlcyB3ZSd2ZSBhbHJlYWR5IHZpc2l0ZWQgZHVyaW5nIERGUy5cbiAgY29uc3QgdmlzaXRlZFNldCA9IHt9O1xuXG4gIC8vIFNldCBvZiBicmlkZ2VzLlxuICBjb25zdCBicmlkZ2VzID0ge307XG5cbiAgLy8gVGltZSBuZWVkZWQgdG8gZGlzY292ZXIgdG8gdGhlIGN1cnJlbnQgdmVydGV4LlxuICBsZXQgZGlzY292ZXJ5VGltZSA9IDA7XG5cbiAgLy8gUGVlayB0aGUgc3RhcnQgdmVydGV4IGZvciBERlMgdHJhdmVyc2FsLlxuICBjb25zdCBzdGFydFZlcnRleCA9IGdyYXBoLmdldEFsbFZlcnRpY2VzKClbMF07XG5cbiAgY29uc3QgZGZzQ2FsbGJhY2tzID0ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7R3JhcGhWZXJ0ZXh9IGN1cnJlbnRWZXJ0ZXhcbiAgICAgKi9cbiAgICBlbnRlclZlcnRleDogKHsgY3VycmVudFZlcnRleCB9KSA9PiB7XG4gICAgICAvLyBUaWNrIGRpc2NvdmVyeSB0aW1lLlxuICAgICAgZGlzY292ZXJ5VGltZSArPSAxO1xuXG4gICAgICAvLyBQdXQgY3VycmVudCB2ZXJ0ZXggdG8gdmlzaXRlZCBzZXQuXG4gICAgICB2aXNpdGVkU2V0W2N1cnJlbnRWZXJ0ZXguZ2V0S2V5KCldID0gbmV3IFZpc2l0TWV0YWRhdGEoe1xuICAgICAgICBkaXNjb3ZlcnlUaW1lLFxuICAgICAgICBsb3dEaXNjb3ZlcnlUaW1lOiBkaXNjb3ZlcnlUaW1lLFxuICAgICAgfSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0dyYXBoVmVydGV4fSBjdXJyZW50VmVydGV4XG4gICAgICogQHBhcmFtIHtHcmFwaFZlcnRleH0gcHJldmlvdXNWZXJ0ZXhcbiAgICAgKi9cbiAgICBsZWF2ZVZlcnRleDogKHsgY3VycmVudFZlcnRleCwgcHJldmlvdXNWZXJ0ZXggfSkgPT4ge1xuICAgICAgaWYgKHByZXZpb3VzVmVydGV4ID09PSBudWxsKSB7XG4gICAgICAgIC8vIERvbid0IGRvIGFueXRoaW5nIGZvciB0aGUgcm9vdCB2ZXJ0ZXggaWYgaXQgaXMgYWxyZWFkeSBjdXJyZW50IChub3QgcHJldmlvdXMgb25lKS5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiBjdXJyZW50IG5vZGUgaXMgY29ubmVjdGVkIHRvIGFueSBlYXJseSBub2RlIG90aGVyIHRoZW4gcHJldmlvdXMgb25lLlxuICAgICAgdmlzaXRlZFNldFtjdXJyZW50VmVydGV4LmdldEtleSgpXS5sb3dEaXNjb3ZlcnlUaW1lID0gY3VycmVudFZlcnRleC5nZXROZWlnaGJvcnMoKVxuICAgICAgICAuZmlsdGVyKGVhcmx5TmVpZ2hib3IgPT4gZWFybHlOZWlnaGJvci5nZXRLZXkoKSAhPT0gcHJldmlvdXNWZXJ0ZXguZ2V0S2V5KCkpXG4gICAgICAgIC5yZWR1Y2UoXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGxvd2VzdERpc2NvdmVyeVRpbWVcbiAgICAgICAgICAgKiBAcGFyYW0ge0dyYXBoVmVydGV4fSBuZWlnaGJvclxuICAgICAgICAgICAqL1xuICAgICAgICAgIChsb3dlc3REaXNjb3ZlcnlUaW1lLCBuZWlnaGJvcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmVpZ2hib3JMb3dUaW1lID0gdmlzaXRlZFNldFtuZWlnaGJvci5nZXRLZXkoKV0ubG93RGlzY292ZXJ5VGltZTtcbiAgICAgICAgICAgIHJldHVybiBuZWlnaGJvckxvd1RpbWUgPCBsb3dlc3REaXNjb3ZlcnlUaW1lID8gbmVpZ2hib3JMb3dUaW1lIDogbG93ZXN0RGlzY292ZXJ5VGltZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHZpc2l0ZWRTZXRbY3VycmVudFZlcnRleC5nZXRLZXkoKV0ubG93RGlzY292ZXJ5VGltZSxcbiAgICAgICAgKTtcblxuICAgICAgLy8gQ29tcGFyZSBsb3cgZGlzY292ZXJ5IHRpbWVzLiBJbiBjYXNlIGlmIGN1cnJlbnQgbG93IGRpc2NvdmVyeSB0aW1lIGlzIGxlc3MgdGhhbiB0aGUgb25lXG4gICAgICAvLyBpbiBwcmV2aW91cyB2ZXJ0ZXggdGhlbiB1cGRhdGUgcHJldmlvdXMgdmVydGV4IGxvdyB0aW1lLlxuICAgICAgY29uc3QgY3VycmVudExvd0Rpc2NvdmVyeVRpbWUgPSB2aXNpdGVkU2V0W2N1cnJlbnRWZXJ0ZXguZ2V0S2V5KCldLmxvd0Rpc2NvdmVyeVRpbWU7XG4gICAgICBjb25zdCBwcmV2aW91c0xvd0Rpc2NvdmVyeVRpbWUgPSB2aXNpdGVkU2V0W3ByZXZpb3VzVmVydGV4LmdldEtleSgpXS5sb3dEaXNjb3ZlcnlUaW1lO1xuICAgICAgaWYgKGN1cnJlbnRMb3dEaXNjb3ZlcnlUaW1lIDwgcHJldmlvdXNMb3dEaXNjb3ZlcnlUaW1lKSB7XG4gICAgICAgIHZpc2l0ZWRTZXRbcHJldmlvdXNWZXJ0ZXguZ2V0S2V5KCldLmxvd0Rpc2NvdmVyeVRpbWUgPSBjdXJyZW50TG93RGlzY292ZXJ5VGltZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29tcGFyZSBjdXJyZW50IHZlcnRleCBsb3cgZGlzY292ZXJ5IHRpbWUgd2l0aCBwYXJlbnQgZGlzY292ZXJ5IHRpbWUuIENoZWNrIGlmIHRoZXJlXG4gICAgICAvLyBhcmUgYW55IHNob3J0IHBhdGggKGJhY2sgZWRnZSkgZXhpc3RzLiBJZiB3ZSBjYW4ndCBnZXQgdG8gY3VycmVudCB2ZXJ0ZXggb3RoZXIgdGhlblxuICAgICAgLy8gdmlhIHBhcmVudCB0aGVuIHRoZSBwYXJlbnQgdmVydGV4IGlzIGFydGljdWxhdGlvbiBwb2ludCBmb3IgY3VycmVudCBvbmUuXG4gICAgICBjb25zdCBwYXJlbnREaXNjb3ZlcnlUaW1lID0gdmlzaXRlZFNldFtwcmV2aW91c1ZlcnRleC5nZXRLZXkoKV0uZGlzY292ZXJ5VGltZTtcbiAgICAgIGlmIChwYXJlbnREaXNjb3ZlcnlUaW1lIDwgY3VycmVudExvd0Rpc2NvdmVyeVRpbWUpIHtcbiAgICAgICAgY29uc3QgYnJpZGdlID0gZ3JhcGguZmluZEVkZ2UocHJldmlvdXNWZXJ0ZXgsIGN1cnJlbnRWZXJ0ZXgpO1xuICAgICAgICBicmlkZ2VzW2JyaWRnZS5nZXRLZXkoKV0gPSBicmlkZ2U7XG4gICAgICB9XG4gICAgfSxcbiAgICBhbGxvd1RyYXZlcnNhbDogKHsgbmV4dFZlcnRleCB9KSA9PiB7XG4gICAgICByZXR1cm4gIXZpc2l0ZWRTZXRbbmV4dFZlcnRleC5nZXRLZXkoKV07XG4gICAgfSxcbiAgfTtcblxuICAvLyBEbyBEZXB0aCBGaXJzdCBTZWFyY2ggdHJhdmVyc2FsIG92ZXIgc3VibWl0dGVkIGdyYXBoLlxuICBkZXB0aEZpcnN0U2VhcmNoKGdyYXBoLCBzdGFydFZlcnRleCwgZGZzQ2FsbGJhY2tzKTtcblxuICByZXR1cm4gYnJpZGdlcztcbn1cbiJdfQ==